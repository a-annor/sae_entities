Loading rhel8/default-amp
  Loading requirement: rhel8/slurm singularity/current rhel8/global cuda/11.4
    libpciaccess/0.16/gcc-9.4.0-6fonbj6 libiconv/1.16/gcc-9.4.0-ahebbov
    libxml2/2.9.12/gcc-9.4.0-gnknt5e ncurses/6.2/gcc-9.4.0-aiirok7
    hwloc/2.5.0/gcc-9.4.0-7sqomga libevent/2.1.12/gcc-9.4.0-hgny7cm
    numactl/2.0.14/gcc-9.4.0-52dwc6n cuda/11.4.0/gcc-9.4.0-3hnxhjt
    gdrcopy/2.2/gcc-9.4.0-e4igtfp knem/1.1.4/gcc-9.4.0-bpbxgva
    libnl/3.3.0/gcc-9.4.0-whwhrwb rdma-core/34.0/gcc-9.4.0-5eo5n2u
    ucx/1.11.1/gcc-9.4.0-lktqyl4 openmpi/4.1.1/gcc-9.4.0-epagguv
/var/spool/slurm/slurmd/job11141724/slurm_script: line 65: conda: command not found
Changed directory to /rds/user/ana42/hpc-work/sae_entities.

JobID: 11141724
======
Time: Mon Jun 16 00:10:26 BST 2025
Running on master node: gpu-q-2
Current directory: /rds/user/ana42/hpc-work/sae_entities

Nodes allocated:
================
gpu-q-2

numtasks=1, numnodes=1, mpi_tasks_per_node=1 (OMP_NUM_THREADS=1)

Executing command:
==================
python -u mech_interp/feature_analysis.py  > logs/out.11141724

Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.43s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.17s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.19it/s]
  0%|          | 0/625 [00:00<?, ?it/s]  9%|▉         | 59/625 [00:00<00:00, 583.76it/s] 19%|█▉        | 119/625 [00:00<00:00, 583.88it/s] 29%|██▊       | 179/625 [00:00<00:00, 588.06it/s] 38%|███▊      | 238/625 [00:00<00:00, 585.49it/s] 48%|████▊     | 299/625 [00:00<00:00, 591.08it/s] 57%|█████▋    | 359/625 [00:00<00:00, 572.04it/s] 67%|██████▋   | 417/625 [00:00<00:00, 570.15it/s] 76%|███████▋  | 478/625 [00:00<00:00, 580.90it/s] 87%|████████▋ | 544/625 [00:00<00:00, 602.65it/s] 98%|█████████▊| 610/625 [00:01<00:00, 617.61it/s]100%|██████████| 625/625 [00:01<00:00, 595.91it/s]
  0%|          | 0/8 [00:00<?, ?it/s]100%|██████████| 8/8 [00:00<00:00, 456.07it/s]
  0%|          | 0/8 [00:00<?, ?it/s]100%|██████████| 8/8 [00:00<00:00, 442.56it/s]
/rds/user/ana42/hpc-work/sae_entities/.venv/lib64/python3.11/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning:

Mean of empty slice.

/rds/user/ana42/hpc-work/sae_entities/.venv/lib64/python3.11/site-packages/numpy/core/_methods.py:129: RuntimeWarning:

invalid value encountered in scalar divide

Traceback (most recent call last):
  File "/rds/user/ana42/hpc-work/sae_entities/mech_interp/feature_analysis.py", line 171, in <module>
    plot_layerwise_latent_scores(model_alias, LAYERS_WITH_SAE, top_scores_layers,
  File "/rds/user/ana42/hpc-work/sae_entities/mech_interp/feature_analysis_utils.py", line 450, in plot_layerwise_latent_scores
    min_scores = [min(top_scores_layers[known_label][entity_type][layer]) for layer in sae_layers]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/rds/user/ana42/hpc-work/sae_entities/mech_interp/feature_analysis_utils.py", line 450, in <listcomp>
    min_scores = [min(top_scores_layers[known_label][entity_type][layer]) for layer in sae_layers]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: min() arg is an empty sequence
